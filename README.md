# MegaSchool 2025 AI track

Этот репозиторий содержит мое решения для основного задания мегашколы ИТМО.

## Задача:

Разработать агента, который будет предоставлять информацию об Университете ИТМО. Этот бот
должен совмещать общие сведения, полученные из языковой модели (например, DeepSeek, GPT,
LLaMA и т.д.), с фактами и дополнительным контекстом, полученным из внешних источников.

## Сборка

Для запуска выполните команду:

```bash
docker-compose up -d
```

Она соберёт Docker-образ, а затем запустит контейнер.

После успешного запуска контейнера приложение будет доступно на http://localhost:8080 
и http://localhost:80 (чтобы мочь привязать dns запись)

_Не забудьте создать файл .env с секретами_

## Применение

Отправьте POST-запрос на эндпоинт /api/request. Например, используйте curl:

```bash
curl --location --request POST 'http://localhost:8080/api/request' \
--header 'Content-Type: application/json' \
--data-raw '{
  "query": "В каком городе находится главный кампус Университета ИТМО?\n1. Москва\n2. Санкт-Петербург\n3. Екатеринбург\n4. Нижний Новгород",
  "id": 1
}'
```

В ответ вы получите JSON вида:

```json
{
  "id": 1 ,
  "answer": 1 ,
  "reasoning": "Из информации на сайте" ,
  "sources": [
    "https://itmo.ru/ru/" ,
    "https://abit.itmo.ru/"
  ]
}
```

id будет соответствовать тому, что вы отправили в запросе

## Технические особенности

В качестве базовой модели я используй yandex gpt lite. Это не агентная система, я 
использую строгую последовательность вызовов. Вызовы выглядят примерно следующим образом:

```
user question -> llm generates search request -> yandex search api -> 

[------------------up to 5 async tasks--------------------]
|                                                         |
|        scrape link, extract text -> llm summarises      | -->
|                                                         |
[---------------------------------------------------------]

converts into context for answer -> llm generates answer -> 
json generation -> +++ Success +++
```

Весь этот зоопарк действий оркеструет класс `YaGPTResponse`
Делал я все так, чтобы можно было заменить его на другую модель просто реализовав 
метод `.answer()`. В идеале конечно было использовать API от OpenAi, но яндекс требует 
свою библиотеку. 

## Ограничения и мои знания

Я тестировал нагрузку только на 15 одновременных запросах, 1 из них упал. Скорее всего,
при итоговом тестировании будет хуже. Вероятно это вызвано ограничением api YandexGPT, 
но моя система никак не отслеживает это. Поэтому и падает(

- Цена 1 запроса: от ~1 до ~7 рублей, в зависимости от количества ретраев. 
- Среднее время на обработку запроса: 12 секунд